<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<meta name="color-scheme" content="dark"/>
<title>Pet Feeder — Pure HTML+SVG</title>
<style>
  :root{
    --ink:#ecf3ff; --mut:#b2c1e8;
    --bg1:#0e1023; --bg2:#0a0c18;
    --card:#141735; --card2:#0e1230; --ring:#ffffff24;
    --g1:#71e1ff; --g3:#c06bff; --ok:#aef7c1; --warn:#ffb36a;
    --btn1:#1b1f49; --btn2:#0f1238;
    --maxw:430px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;background:
      radial-gradient(1200px 800px at 70% -20%, #20235a 0%, transparent 60%),
      linear-gradient(180deg,var(--bg1),var(--bg2));
    color:var(--ink);font:15px/1.45 Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;
    display:grid;place-items:center;padding:10px;
  }
  .shell{width:min(95vw,var(--maxw)); display:flex; flex-direction:column; gap:10px}

  .hud{display:flex; justify-content:space-between; align-items:center; padding:2px 2px 0}
  .levelTag{font-weight:800; letter-spacing:.5px; text-shadow:0 2px 10px rgba(0,0,0,.5)}
  .pill{display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:999px;
    background:linear-gradient(180deg,#1b1e4a,#0f1238); border:1px solid var(--ring);
    box-shadow:inset 0 0 24px rgba(192,107,255,.18), 0 6px 18px rgba(0,0,0,.35); font-weight:700;}
  .cookie{width:16px;height:16px;border-radius:50%;display:inline-block;position:relative;
    background:radial-gradient(circle at 35% 35%, #ffdfb2, #ffb36a 70%);box-shadow:inset 0 0 0 2px #00000022;}
  .cookie:before,.cookie:after{content:"";position:absolute;background:#b87040;border-radius:50%}
  .cookie:before{width:4px;height:4px;left:4px;top:4px}
  .cookie:after{width:5px;height:5px;right:3px;bottom:3px}

  .stage{
    width:100%; aspect-ratio:9/16; border-radius:22px; overflow:hidden;
    box-shadow: 0 0 0 3px var(--ring) inset, 0 18px 50px rgba(0,0,0,.45);
    background:#0d0f24; display:grid; place-items:center;
  }
  svg{width:100%; height:100%}

  /* Card */
  .card{background:linear-gradient(180deg,var(--card),var(--card2));border:1px solid var(--ring);
    border-radius:20px;padding:14px;box-shadow:0 10px 40px rgba(0,0,0,.42), inset 0 0 40px rgba(120,115,245,.12);}
  .bar{height:12px;background:#0f1337;border:1px solid var(--ring);border-radius:999px;overflow:hidden}
  .fill{height:100%;width:0%;background:linear-gradient(90deg,var(--g1),var(--g3));box-shadow:0 0 20px rgba(113,225,255,.45)}
  .barLabel{display:flex;justify-content:space-between;font-size:12px;color:var(--mut);margin:6px 2px 10px}
  .row{display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap}
  .btn{appearance:none;border:none;color:var(--ink);cursor:pointer;user-select:none;padding:12px 18px;border-radius:14px;
    font-weight:800;letter-spacing:.4px;background:linear-gradient(180deg,var(--btn1),var(--btn2));border:1px solid var(--ring);
    box-shadow:0 10px 24px rgba(0,0,0,.35), inset 0 0 24px rgba(120,115,245,.18);}
  .btn:disabled{opacity:.5;filter:grayscale(.2);cursor:not-allowed}
  .capacity{font-size:12px;color:var(--mut)}
  .ladder{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:10px}
  .reward{background:linear-gradient(180deg,#1a1e4a,#11153e);border:1px solid var(--ring);border-radius:14px;padding:8px;text-align:center;
    box-shadow:inset 0 0 24px rgba(113,225,255,.12)}
  .reward .icon{width:34px;height:34px;border-radius:10px;margin:0 auto 6px;
    background:radial-gradient(circle at 35% 35%, #ffd86a, #ff9a2e 70%);box-shadow:0 0 16px rgba(255,216,106,.35), inset 0 0 0 2px #00000022;
    position:relative}
  .reward .icon:after{content:"★";color:#3b2a00;position:absolute;inset:0;display:grid;place-items:center;font-size:18px;font-weight:900}
  .reward.locked{opacity:.5}
  .reward.done .icon{background:radial-gradient(circle at 35% 35%, var(--ok), #15b88a 70%);box-shadow:0 0 16px rgba(174,247,193,.5)}
  .reward small{color:var(--mut);display:block;font-size:11px}
  .note{color:var(--mut);font-size:12px;text-align:center}

  /* Pet animations (SVG groups via CSS) */
  @keyframes floaty{0%{transform:translateY(0)}50%{transform:translateY(6px)}100%{transform:translateY(0)}}
  @keyframes blink{0%,92%,100%{transform:scaleY(1)}96%{transform:scaleY(.15)}}
  @keyframes pop{0%{transform:scale(1)}50%{transform:scale(.96,1.04)}100%{transform:scale(1)}}
  .pet{animation:floaty 1.2s ease-in-out infinite}
  .eyes{transform-origin:center; animation:blink 2.4s ease-in-out infinite}
  .pet.pop{animation:pop .18s ease-out 1}
/* add these or merge with existing rules */
.pet, .eyes{
  transform-box: fill-box;      /* <-- anchor transform to this group's bounds */
  transform-origin: 50% 50%;    /* center so scaleY won't shift position */
}

/* replace your blink keyframes with this version */
@keyframes blink{
  0%,92%,100%{ transform: translateY(0) scaleY(1); }
  96%{        transform: translateY(0) scaleY(.15); } /* no vertical drift */
}

/* optional: help some GPUs keep it crisp */
.eyes{ will-change: transform; }

  /* Heart particles */
  .heart{transform-origin:center; opacity:.9; }
  @keyframes rise{0%{transform:translateY(0) scale(.8); opacity:.9}100%{transform:translateY(-90px) scale(0.1); opacity:0}}
</style>
</head>
<body>
  <div class="shell">
    <div class="hud">
      <div class="levelTag">LEVEL <span id="lvlText">1</span>/8</div>
      <div class="pill"><span class="cookie"></span>
        <span id="cookiesText">0</span>/<span id="capText">50</span>
      </div>
    </div>

    <!-- Stage (SVG) -->
    <div class="stage">
      <svg viewBox="0 0 360 640" role="img" aria-label="Pet scene" id="svg">
        <!-- Sky -->
        <defs>
          <linearGradient id="sky" x1="0" y1="0" x2="0" y2="1">
            <stop offset="0%" stop-color="#79c1ff"/>
            <stop offset="70%" stop-color="#a7d7ff"/>
          </linearGradient>
        </defs>
        <rect x="0" y="0" width="360" height="640" fill="url(#sky)"/>
        <!-- Hills -->
        <path d="M0,360 C60,340 120,380 180,360 C240,340 300,380 360,360 L360,640 L0,640 Z" fill="#87a7ff" opacity=".8"/>
        <path d="M0,410 C60,390 120,430 180,410 C240,390 300,430 360,410 L360,640 L0,640 Z" fill="#5f7cff" opacity=".9"/>
        <!-- Crater -->
        <rect x="40" y="384" width="280" height="100" rx="28" fill="#f6d069"/>
        <rect x="70" y="404" width="220" height="60" rx="22" fill="#d7a24b"/>

        <!-- Shrubs -->
        <g fill="#123f39" opacity=".9">
          <circle cx="40" cy="470" r="30"/><circle cx="62" cy="476" r="28"/><circle cx="18" cy="476" r="26"/>
        </g>
        <g fill="#163e58" opacity=".9">
          <circle cx="300" cy="478" r="30"/><circle cx="322" cy="484" r="28"/><circle cx="278" cy="484" r="26"/>
        </g>

        <!-- PET -->
        <g id="pet" class="pet" transform="translate(180, 345)">
          <!-- ears -->
          <ellipse cx="-56" cy="-48" rx="27" ry="18" fill="#87d4ff" stroke="#2a75a8" stroke-width="6" opacity=".9"/>
          <ellipse cx="56" cy="-48" rx="27" ry="18" fill="#87d4ff" stroke="#2a75a8" stroke-width="6" opacity=".9"/>
          <!-- body -->
          <ellipse cx="0" cy="0" rx="80" ry="60" fill="#67c3ff" stroke="#2a75a8" stroke-width="8" opacity=".95"/>
          <ellipse cx="0" cy="10" rx="55" ry="35" fill="#9ddcff" opacity=".85"/>
          <!-- eyes -->
          <g class="eyes">
            <ellipse cx="-28" cy="-8" rx="12" ry="14" fill="#0e1a2a"/>
            <ellipse cx="28" cy="-8" rx="12" ry="14" fill="#0e1a2a"/>
            <circle cx="-32" cy="-14" r="4" fill="#fff" opacity=".9"/>
            <circle cx="24" cy="-14" r="4" fill="#fff" opacity=".9"/>
          </g>
          <!-- nose -->
          <ellipse cx="0" cy="12" rx="18" ry="13" fill="#3b80d1"/>
        </g>

        <!-- Particle layer -->
        <g id="particles"></g>
      </svg>
    </div>

    <div class="card">
      <div class="bar"><div id="xpFill" class="fill"></div></div>
      <div class="barLabel">
        <span>XP: <b id="xpNow">0</b>/<span id="xpNeed">20</span></span>
        <span id="nextRewardTxt">1 level(s) to next reward</span>
      </div>
      <div class="row">
        <button id="feedBtn" class="btn">FEED</button>
        <div class="capacity" id="regenTxt">Next cookie in 10s</div>
      </div>
      <div class="ladder" id="ladder"></div>
      <div class="note">Progress is auto-saved on your device.</div>
    </div>
  </div>

<script>
/* ======= No-asset sounds (Web Audio) ======= */
const Snd=(()=>{
  const Ctx=window.AudioContext||window.webkitAudioContext; let ctx;
  function ensure(){return ctx||(ctx=new Ctx())}
  function beep(f=440,d=.08,t='sine',g=.03){
    const ac=ensure(),o=ac.createOscillator(),ga=ac.createGain();
    o.type=t;o.frequency.value=f;ga.gain.value=g;o.connect(ga).connect(ac.destination);
    o.start();o.stop(ac.currentTime+d);
  }
  return{ok(){beep(880,.08,'square',.045)},deny(){beep(180,.2,'triangle',.05)},level(){beep(660,.11,'sawtooth',.055);setTimeout(()=>beep(990,.12,'sawtooth',.045),90)}};
})();

/* ======= Game state & constants ======= */
const SAVE='pet_save_v1_svg';
const MAX_LEVEL=8;
const XP_NEED=[20,30,40,60,80,100,120];
const REWARD_LEVELS=[2,4,6,8];
const CAPACITY=50;
const REGEN_SEC=10;

let state={level:1,xp:0,cookies:8,capacity:CAPACITY,fedTotal:0,lastTick:Date.now()};
try{Object.assign(state,JSON.parse(localStorage.getItem(SAVE)||'{}'));}catch{}

/* ======= UI refs ======= */
const lvlText=document.getElementById('lvlText');
const cookiesText=document.getElementById('cookiesText');
const capText=document.getElementById('capText'); capText.textContent=state.capacity;
const xpNow=document.getElementById('xpNow');
const xpNeed=document.getElementById('xpNeed');
const xpFill=document.getElementById('xpFill');
const feedBtn=document.getElementById('feedBtn');
const regenTxt=document.getElementById('regenTxt');
const nextRewardTxt=document.getElementById('nextRewardTxt');
const ladder=document.getElementById('ladder');
const pet=document.getElementById('pet');
const particles=document.getElementById('particles');

REWARD_LEVELS.forEach(L=>{
  const cell=document.createElement('div'); cell.className='reward locked'; cell.dataset.level=L;
  cell.innerHTML=`<div class="icon"></div><div><b>LV ${L}</b></div><small>Reward</small>`;
  ladder.appendChild(cell);
});

/* ======= Logic ======= */
function save(){localStorage.setItem(SAVE,JSON.stringify(state))}
function addXp(n){
  if(state.level>=MAX_LEVEL) return;
  state.xp+=n; state.fedTotal++;
  const need=XP_NEED[state.level-1];
  if(state.xp>=need){state.xp-=need; state.level=Math.min(MAX_LEVEL,state.level+1); Snd.level();}
  save(); refreshUI();
}
function spendCookie(){ if(state.cookies<=0) return false; state.cookies--; save(); refreshUI(); return true; }
function regenCookies(){
  const now=Date.now(), elapsed=Math.floor((now-state.lastTick)/1000);
  if(elapsed>=1){
    const ticks=Math.floor(elapsed/REGEN_SEC);
    if(ticks>0 && state.cookies<state.capacity){
      state.cookies=Math.min(state.capacity,state.cookies+ticks);
      state.lastTick+=ticks*REGEN_SEC*1000; save(); refreshUI();
    } else { refreshUI(false); }
  }
}

/* ======= Particles (SVG hearts) ======= */
function heartBurst(x=180,y=315,count=10){
  for(let i=0;i<count;i++){
    const ang=(Math.random()*60+120)*Math.PI/180;
    const dist=Math.random()*60+30;
    const hx=x+Math.cos(ang)*dist, hy=y+Math.sin(ang)*dist;
    const c=document.createElementNS('http://www.w3.org/2000/svg','g');
    c.setAttribute('class','heart');
    c.style.animation=`rise ${700+Math.random()*500}ms ease-out forwards`;
    c.style.transform=`translate(${x}px, ${y}px) scale(${.5+Math.random()*0.6})`;
    c.innerHTML=`<path fill="#ff6699" d="M0-4 C-3-10,-12-8,-12-2 C-12,4,-6,8,0,12 C6,8,12,4,12,-2 C12,-8,3,-10,0-4z"/>`;
    particles.appendChild(c);
    setTimeout(()=>particles.removeChild(c),1000);
  }
}

/* ======= Feed button ======= */
feedBtn.addEventListener('click',()=>{
  if(!spendCookie()){Snd.deny();return;}
  addXp(5); Snd.ok();
  pet.classList.remove('pop'); void pet.offsetWidth; pet.classList.add('pop');
  heartBurst();
});

/* ======= Ticker ======= */
setInterval(regenCookies,250);

/* ======= UI ======= */
function refreshUI(updateLadder=true){
  lvlText.textContent=state.level;
  cookiesText.textContent=state.cookies;
  xpNow.textContent=state.xp;
  const need=XP_NEED[state.level-1]||XP_NEED.at(-1);
  xpNeed.textContent=(state.level>=MAX_LEVEL)?state.xp:need;
  const pct=(state.level>=MAX_LEVEL)?100:Math.max(0,Math.min(100,state.xp/need*100));
  xpFill.style.width=pct+'%';

  const secs=REGEN_SEC - Math.floor((Date.now()-state.lastTick)/1000 % REGEN_SEC);
  regenTxt.textContent=(state.cookies>=state.capacity)?'Capacity full':`Next cookie in ${secs}s`;

  const nextLvl=REWARD_LEVELS.find(L=>L>state.level)||MAX_LEVEL;
  const gap=Math.max(0,nextLvl-state.level);
  nextRewardTxt.textContent=(gap===0)?'Final reward reached':`${gap} level(s) to next reward`;

  feedBtn.disabled=(state.cookies<=0 || state.level>=MAX_LEVEL);

  if(updateLadder){
    document.querySelectorAll('.reward').forEach(el=>{
      const L=+el.dataset.level;
      el.classList.toggle('done',state.level>=L);
      el.classList.toggle('locked',state.level<L);
    });
  }
}
if(!state.lastTick){state.lastTick=Date.now();save();}
refreshUI();
</script>
</body>
</html>
